<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.SalesIncentiveDao">
	<!-- 添加销售团队类型 -->
	<insert id="addSalesteamTypeTab" parameterType="java.util.HashMap">
		insert into salesteam_type_tab(salesteam_type_name, salesteam_type_weight) VALUES (#{salesteam_type_name},#{salesteam_type_weight})
	</insert>
	<!-- 查询销售类型信息 -->
	<select id="querySalesteamTypeTab" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select salesteam_type_id,salesteam_type_name,salesteam_type_weight from salesteam_type_tab order by salesteam_type_weight desc
	</select>
	<!-- 更新销售类型信息 -->
	<update id="updateSalesteamTypeTab" parameterType="java.util.HashMap">
		update salesteam_type_tab
		<trim prefix="set" suffixOverrides=",">
			<if test="salesteam_type_name!=null">
				salesteam_type_name=#{salesteam_type_name},
			</if>
			<if test="salesteam_type_weight!=null">
				salesteam_type_weight=#{salesteam_type_weight},
			</if>
		</trim>
		WHERE salesteam_type_id =#{salesteam_type_id}
	</update>
	<!-- 删除销售团队类型 -->
	<delete id="deleteSalesteamTypeTab" parameterType="java.util.ArrayList">
		delete from salesteam_type_tab where 1=1
		and salesteam_type_id in
		<foreach collection="list" item="salesteam_type_id" index="index"
					open="(" close=")" separator=",">
					#{salesteam_type_id}
		</foreach> 
	</delete>
	<!-- 添加销售团队信息 -->
	<insert id="addSalesteamTab" parameterType="java.util.HashMap">
		insert into salesteam_tab(salesteam_type_id, salesteam_name, salesteam_weight) VALUES 
		(#{salesteam_type_id},#{salesteam_name},#{salesteam_weight})
	</insert>
	<!-- 查询销售团队信息 -->
	<select id="querySalesteamTab" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select salesteam_type_name,salesteam_id,sale.salesteam_type_id,salesteam_name,salesteam_weight from salesteam_tab sale
		left join salesteam_type_tab sale_type on sale.salesteam_type_id = sale_type.salesteam_type_id order by salesteam_weight desc
	</select>
	<!-- 更新销售团队信息 -->
	<update id="updateSalesteamTab" parameterType="java.util.HashMap">
		update salesteam_tab
		<trim prefix="set" suffixOverrides=",">
			<if test="salesteam_type_id!=null">
				salesteam_type_id=#{salesteam_type_id},
			</if>
			<if test="salesteam_name!=null">
				salesteam_name=#{salesteam_name},
			</if>
			<if test="salesteam_weight!=null">
				salesteam_weight=#{salesteam_weight},
			</if>
		</trim>
		where salesteam_id = #{salesteam_id}
	</update>
	<!-- 删除销售团队信息 -->
	<delete id="deleteSalesteamTab" parameterType="java.util.ArrayList">
		delete from salesteam_tab where  salesteam_id in 
		<foreach collection="list" item="salesteam_id" index="index"
					open="(" close=")" separator=",">
					#{salesteam_id}
		</foreach> 
	</delete>
	<!-- 添加团队员工 -->
	<insert id="addSalesteamStaffMiddleTab" parameterType="java.util.HashMap">
		insert into salesteam_staff_middle_tab(salesteam_id,staf_id) values 
		(#{salesteam_id},#{staf_id})
	</insert>
	<!-- 删除团队员工 -->
	<delete id="deleteSalesteamStaffMiddleTab" parameterType="java.util.ArrayList">
		delete from salesteam_staff_middle_tab where sale_staf_id in 
		<foreach collection="list" item="sale_staf_id" index="index"
					open="(" close=")" separator=",">
					#{sale_staf_id}
		</foreach> 
	</delete>
	<!-- 查询团队员工 -->
	<select id="querySalesteamStaffMiddleTab" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT tab.salesteam_type_name,staf.staf_name,sale_staf_id,st.salesteam_id,st.salesteam_name FROM salesteam_staff_middle_tab sale_staff
		left join salesteam_tab st on sale_staff.salesteam_id = st.salesteam_id
		left join staff_tab staf on sale_staff.staf_id = staf.staf_id
		left join salesteam_type_tab tab on st.salesteam_type_id = tab.salesteam_type_id
		where 1=1
		<if test="salesteam_id!=null">
			and st.salesteam_id =#{salesteam_id}
		</if>
		<if test="staf_id!=null">
			and staf.staf_id = #{staf_id}
		</if>
	</select>
	<!-- 添加品类提成配置信息 -->
	<insert id="addCommissionsTab" parameterType="java.util.HashMap">
		insert into commissions_tab(cate_id, commissions_money, salesteam_id) values 
		(#{cate_id},#{commissions_money},#{salesteam_id})
	</insert>
	<!-- 查询品类提成配置信息 -->
	<select id="queryCommissionsTab" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select st.salesteam_name,commissions_id,comm.cate_id,commissions_money,st.salesteam_id,cate_name from commissions_tab comm
		left join category_tab tab on comm.cate_id = tab.cate_id
		left join salesteam_tab st on comm.salesteam_id = st.salesteam_id
	</select>
	<!-- 修改品类提成配置信息 -->
	<update id="updateCommissionsTab" parameterType="java.util.HashMap">
		update commissions_tab 
		<trim prefix="set" suffixOverrides=",">
			<if test="cate_id!=null">
				cate_id=#{cate_id},
			</if>
			<if test="commissions_money!=null">
				commissions_money=#{commissions_money},
			</if>
			<if test="salesteam_id!=null">
				salesteam_id=#{salesteam_id},
			</if>
		</trim>
		where commissions_id =#{commissions_id}
	</update>
	<!-- 删除品类提成配置信息 -->
	<delete id="deleteCommissionsTab" parameterType="java.util.ArrayList">
		delete from commissions_tab where commissions_id in 
		<foreach collection="list" item="commissions_id" index="index"
					open="(" close=")" separator=",">
					#{commissions_id}
		</foreach> 
	</delete>
	<!-- 添加考核额度信息 -->
	<insert id="addAssessTab" parameterType="java.util.HashMap">
		insert into assess_tab(salesteam_id, assess_standard, assess_up, assess_up_money, assess_down, assess_down_money) VALUES 
		(#{salesteam_id},#{assess_standard},#{assess_up},#{assess_up_money},#{assess_down},#{assess_down_money})	
	</insert>
	<!-- 查询考核额度信息 -->
	<select id="queryAssessTab" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		select salesteam_name,assess_id,ass.salesteam_id,assess_standard,assess_up,assess_up_money,assess_down,assess_down_money from assess_tab ass
		left join salesteam_tab st on ass.salesteam_id = st.salesteam_id;
	</select>
	<!-- 修改考核额度表信息 -->
	<update id="updateAssessTab" parameterType="java.util.HashMap">
		update assess_tab
		<trim prefix="set" suffixOverrides=",">
			<if test="salesteam_id!=null">
				salesteam_id=#{salesteam_id},
			</if>
			<if test="assess_standard!=null">
				assess_standard=#{assess_standard},
			</if>
			<if test="assess_up!=null">
				assess_up=#{assess_up},
			</if>
			<if test="assess_up_money!=null">
				assess_up_money=#{assess_up_money},
			</if>
			<if test="assess_down!=null">
				assess_down=#{assess_down},
			</if>
			<if test="assess_down_money!=null">
				assess_down_money=#{assess_down_money},
			</if>
		</trim>
		where assess_id =#{assess_id}
	</update>
	<!-- 删除考核额度表信息 -->
	<delete id="deleteAssessTab" parameterType="java.util.ArrayList">
		delete from assess_tab where assess_id in 
		<foreach collection="list" item="assess_id" index="index"
					open="(" close=")" separator=",">
					#{assess_id}
		</foreach> 
	</delete>
</mapper>