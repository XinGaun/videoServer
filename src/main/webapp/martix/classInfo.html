<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title></title>
<link href="assets/css/bootstrap.css" rel="stylesheet" />
<link href="assets/css/font-awesome.css" rel="stylesheet" />
<link href="assets/css/custom-styles.css" rel="stylesheet" />
<link href='http://fonts.googleapis.com/css?family=Open+Sans'
	rel='stylesheet' type='text/css' />
<link href="assets/js/dataTables/dataTables.bootstrap.css"
	rel="stylesheet" />

<style type="text/css">
.wrap {
	width: 150px; /* 设置需要固定的宽度 */
	white-space: nowrap; /* 不换行 */
	text-overflow: ellipsis; /*  超出部分用....代替 */
	overflow: hidden; /* 超出隐藏 */ 
}

table {
	table-layout: fixed;
	width: 1300px;
	
};
  .toolbar {
            border: 1px solid #ccc;
           
   }
  .text {
            border: 1px solid #ccc;
            width:100%;
            height: 325px;
            max-height:320px;
        }
</style>
	<!-- 富文本 -->
	<script type="text/javascript"  src="js/wangEditor.min.js"></script>

</head>
<body>
	<div id="wrapper">
		<nav class="navbar navbar-default top-navbar" role="navigation">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".sidebar-collapse">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#"><i
					class="fa fa-comments"></i> <strong><span
						style="font-size: 25px;">语道后台管理 </span></strong></a>
			</div>

			<!-- <ul class="nav navbar-top-links navbar-right">
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown" href="#" aria-expanded="false"> <i
						class="fa fa-envelope fa-fw"></i> <i class="fa fa-caret-down"></i>
				</a>
					<ul class="dropdown-menu dropdown-messages">
						<li><a href="#">
								<div>
									<strong>JohnDoe</strong> <span class="pull-right text-muted">
										<em>Today</em>
									</span>
								</div>
								<div>LoremIpsum has been the industry's standard dummy
									text ever since the 1500s...</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<strong>JohnSmith</strong> <span class="pull-right text-muted">
										<em>Yesterday</em>
									</span>
								</div>
								<div>LoremIpsum has been the industry's standard dummy
									text ever since an kwilnw...</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<strong>JohnSmith</strong> <span class="pull-right text-muted">
										<em>Yesterday</em>
									</span>
								</div>
								<div>LoremIpsum has been the industry's standard dummy
									text ever since the...</div>
						</a></li>
						<li class="divider"></li>
						<li><a class="text-center" href="#"> <strong>Read
									All Messages</strong> <i class="fa fa-angle-right"></i>
						</a></li>
					</ul> /.dropdown-messages</li>
				/.dropdown
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown" href="#" aria-expanded="false"> <i
						class="fa fa-tasks fa-fw"></i> <i class="fa fa-caret-down"></i>
				</a>
					<ul class="dropdown-menu dropdown-tasks">
						<li><a href="#">
								<div>
									<p>
										<strong>Task 1</strong> <span class="pull-right text-muted">60%
											Complete</span>
									</p>
									<div class="progress progress-striped active">
										<div class="progress-bar progress-bar-success"
											role="progressbar" aria-valuenow="60" aria-valuemin="0"
											aria-valuemax="100" style="width: 60%">
											<span class="sr-only">60% Complete (success)</span>
										</div>
									</div>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<p>
										<strong>Task 2</strong> <span class="pull-right text-muted">28%
											Complete</span>
									</p>
									<div class="progress progress-striped active">
										<div class="progress-bar progress-bar-info" role="progressbar"
											aria-valuenow="28" aria-valuemin="0" aria-valuemax="100"
											style="width: 28%">
											<span class="sr-only">28% Complete</span>
										</div>
									</div>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<p>
										<strong>Task 3</strong> <span class="pull-right text-muted">60%
											Complete</span>
									</p>
									<div class="progress progress-striped active">
										<div class="progress-bar progress-bar-warning"
											role="progressbar" aria-valuenow="60" aria-valuemin="0"
											aria-valuemax="100" style="width: 60%">
											<span class="sr-only">60% Complete (warning)</span>
										</div>
									</div>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<p>
										<strong>Task 4</strong> <span class="pull-right text-muted">85%
											Complete</span>
									</p>
									<div class="progress progress-striped active">
										<div class="progress-bar progress-bar-danger"
											role="progressbar" aria-valuenow="85" aria-valuemin="0"
											aria-valuemax="100" style="width: 85%">
											<span class="sr-only">85% Complete (danger)</span>
										</div>
									</div>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a class="text-center" href="#"> <strong>See
									All Tasks</strong> <i class="fa fa-angle-right"></i>
						</a></li>
					</ul> /.dropdown-tasks</li>
				/.dropdown
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown" href="#" aria-expanded="false"> <i
						class="fa fa-bell fa-fw"></i> <i class="fa fa-caret-down"></i>
				</a>
					<ul class="dropdown-menu dropdown-alerts">
						<li><a href="#">
								<div>
									<i class="fa fa-comment fa-fw"></i> New Comment <span
										class="pull-right text-muted small">4 min</span>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<i class="fa fa-twitter fa-fw"></i> 3 New Followers <span
										class="pull-right text-muted small">12 min</span>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<i class="fa fa-envelope fa-fw"></i> Message Sent <span
										class="pull-right text-muted small">4 min</span>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<i class="fa fa-tasks fa-fw"></i> New Task <span
										class="pull-right text-muted small">4 min</span>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a href="#">
								<div>
									<i class="fa fa-upload fa-fw"></i> Server Rebooted <span
										class="pull-right text-muted small">4 min</span>
								</div>
						</a></li>
						<li class="divider"></li>
						<li><a class="text-center" href="#"> <strong>See
									All Alerts</strong> <i class="fa fa-angle-right"></i>
						</a></li>
					</ul> /.dropdown-alerts</li>
				/.dropdown
				<li class="dropdown"><a class="dropdown-toggle"
					data-toggle="dropdown" href="#" aria-expanded="false"> <i
						class="fa fa-user fa-fw"></i> <i class="fa fa-caret-down"></i>
				</a>
					<ul class="dropdown-menu dropdown-user">
						<li><a href="#"><i class="fa fa-user fa-fw"></i> User
								Profile</a></li>
						<li><a href="#"><i class="fa fa-gear fa-fw"></i> Settings</a>
						</li>
						<li class="divider"></li>
						<li><a href="javascript:teacherLoginOut()"><i
								class="fa fa-sign-out fa-fw"></i> Logout</a></li>
					</ul> /.dropdown-user</li>
				/.dropdown
			</ul> -->
		</nav>
		<!--/. NAV TOP  -->
		<nav class="navbar-default navbar-side" role="navigation">
			<div class="sidebar-collapse">
				<ul class="nav" id="main-menu">
					<li class="role" style="display: none;"><a href="#"><i
							class="fa fa-sitemap" class="active-menu"></i>权限管理<span
							class="fa arrow"></span></a>
						<ul class="nav nav-second-level">
							<li><a href="role_list.html"><i class="fa fa-lock"></i>
									权限管理</a></li>
							<li><a href="teacher_list.html"><i class="fa fa-users"></i>
									教师管理</a></li>
							<li><a href="user_list.html"><i class="fa fa-user"></i>
									用户管理</a></li>
						</ul></li>
					<li><a href="videoformtab.html"><i class="fa fa-table"></i>视频类型管理</a></li>
					<li><a href="videoInfo.html"><i class="fa fa-table"></i>视频管理</a>
					</li>
					<li><a href="classInfo.html" class="active-menu"><i
							class="fa fa-edit"></i>课程管理</a></li>
							 <li class="role" style="display: none;">
							<a href="coupon.html"><i class="fa fa-qrcode"></i>优惠券管理</a>
						</li>
					<li><a href="comment.html"><i class="fa fa-table"></i>评论管理</a>
					</li>
					<li class="role" style="display: none;"><a href="order.html"><i
							class="fa fa-table"></i>订单管理</a></li>
					<li class="role" style="display: none;"><a
						href="proposal.html"><i class="fa fa-edit"></i>建议管理</a></li>
					<li class="role" style="display: none;"><a href="test.html"><i
							class="fa fa-edit"></i>题目管理</a></li>
					<li class="role" style="display: none;"><a href="#"><i
							class="fa fa-sitemap" >
						</i>首页管理<span
							class="fa arrows"></span></a>
						<ul class="nav nav-second-level">
							<li><a href="inform.html"><i class="fa fa-table"></i>通知管理</a></li>
							<li><a href="teacher_show.html" ><i
									class="fa fa-table"></i>教师展示</a></li>
							<li><a href="rollplay.html"><i class="fa fa-table"></i>滚播管理</a></li>
						</ul></li>
				</ul>
			</div>
		</nav>
		<!-- /. NAV SIDE  -->
		<div id="page-wrapper">
			<div id="page-inner">
				<div class="row">
					<div class="col-md-12">
						<h1 class="page-header">
							语道 <small>课程管理</small>
						</h1>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="panel panel-default">
							<div class="table-responsive">
								<table class="table"
									class="display table-striped table-bordered table-hover table-condensed"
									cellspacing="0" width="100%">
									<tr>
										<td>
											<div class="input-group" width="100%">
												<span class="input-group-addon">课程名称</span> <input
													type="text" class="form-control" placeholder="请输入课程名称"
													id="courses_name">
											</div>
										</td>
										<td>
											<div class="input-group" width="100%">
												<span class="input-group-addon">课程类型</span> <select
													style="text-align: center;" id="video_form_name">
												</select>
											</div>
										</td>
										<td>
											<div class="input-group" width="100%">
												<span class="input-group-addon">课程价格</span> <input
													type="text" class="form-control" placeholder="请输入课程价格"
													id="courses_pricemoney">
											</div>
										</td>
										<td>
											<div class="input-group" width="100%">
												<span class="input-group-addon">课程评分</span> <input
													type="text" class="form-control" placeholder="请输入课程评分"
													id="courses_grade">
											</div>
										</td>
									</tr>
									<tr>

									</tr>
									<tr>
										<td>
											<button type="button" class="btn btn-danger" id="removeorder"
												data-toggle="modal" data-target="#myModal">添加课程</button>
										</td>
										<td></td>
										<td></td>
										<td>
											<div style="float: right">
												<button type="button" class="btn btn-primary"
													id="queryorder">搜索</button>
												&nbsp;&nbsp; &nbsp;&nbsp;
												<button type="button" class="btn btn-warning"
													id="eliminates">清空</button>
											</div>
										</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<!-- Advanced Tables -->
						<div class="panel panel-default">

							<div class="panel-body"
								style="overflow-x: scroll; max-height: 650px; width: 99%;">
								<table  class='table table-bordered'
									style="width: 1300px;">
									<thead>
									  <tr>
										<td>序号</td>
										<td>课程名称</td>
										<td>课程类型</td>
								<!-- 		<td>课程介绍</td> -->
										<td>课程视频</td>
										<td>课程图片</td>
										<td>课程价格</td>
										<td>课程评分</td>
										<td>点击次数</td>
										<td>视频权重</td>
										<td>修改</td>
										<td>状态</td>
									</tr></thead>
									<tbody id = "tb">
										
									</tbody>
								</table>
					<div>
						<span id="btn0"></span> <!-- <span>每页</span><input id="pageSize" type="text" size="1" maxlength="2" value="getDefaultValue()" /><span> 条 </span>  -->
					   <a href="#" id="btn1">首页</a> <a href="#" id="btn2">上一页</a> 
					   <a href="#" id="btn3">下一页</a> <a href="#" id="btn4">尾页</a>&nbsp; <a>转到&nbsp;</a>
					   <input id="changePage" type="text" size="1" maxlength="4" /> <a>页&nbsp;</a><a href="#" id="btn5">跳转</a>
					</div>							
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
		<!-- Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
			aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content" style="width: 865px;">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">课程视频添加</h4>
					</div>
					<form action="/videoServer/videoTab/uploadflv1.do" method="post"
						enctype="multipart/form-data">
						<div style="width: 860px;">
							<div style="height: 30px; background: #D9ECFF;"></div>
							<div style="height: 50px;">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px;">课程名称：</div>
								<div
									style="width: 300px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">
									<input type="text" style="width: 100%; height: 100%;" id="name" />
								</div>
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程类型：</div>
								<div
									style="width: 250px; height: 50px; float: left; border: 1px solid #CADEFD;">
									<select style="text-align: center; width:249px; height:50px;" id="kctype" ></select>
								</div>
							</div>
							<div style="height: 200px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 200px; line-height: 200px;">选择视频：</div>
								<div
									style="width: 700px; height: 200px; float: left; overflow: scroll; border: 1px solid #CADEFD;">
									<!-- <select id="courses_video"><option>请选择视频</option></select> -->
									<table id="courses_video" class='table table-bordered'></table>
								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程图片：</div>
								<div
									style="width: 700px; height: 50px; float: left; border: 1px solid #CADEFD;">
									&nbsp;<input type="file" id="courses_image" accept="image/*">
								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程价格：</div>
								<div
									style="width: 700px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">

									<input type="text" id="jiage"
										style="width: 100%; height: 50px;"
										placeholder="请输入课程价格，如99.99" onkeyup="checknum(this);" />

								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程现价：</div>
								<div
									style="width: 700px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">

									<input type="text" id="xianjia"
										style="width: 100%; height: 50px;"
										placeholder="请输入课程价格，如99.99" onkeyup="checknum(this);" />

								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									  style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">排序权重：</div>
								<div style="width: 700px; height: 50px; float: left;">
									&nbsp;
									<div style="margin-left: 320px;">
										<input type="button" style="border-right: 0px;"
											onClick="disNum(this)" value="-"><input type="text"
											value="0" id="courses_qz"
											style="width: 30px; text-align: center"
											onkeyup="value=value.replace(/[^\d]/g,'1')" /><input
											type="button" value="+" style="border-left: 0px;"
											onClick="incNum(this)">
									</div>
								</div>
							</div>
							<div style="height: 350px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 350px; line-height: 350px;">课程介绍：</div>

								<div style="width: 650px; height: 325px; float: left;">
									 <div id="div1" class="toolbar"></div>
									 <div id="div2" class="text"> 
                                         
                                      </div>
								</div>
								</div>
								
						</div>
					</form>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal"
							id="quxiao">取消</button>
						<button type="button" class="btn btn-primary" id="sub">提交</button>
					</div>
				</div>
			</div>
		</div>

		<!--update class Modal -->
		<div class="modal fade" id="updateClassModal" tabindex="-1"
			role="dialog" aria-labelledby="updateClassModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content"  style="width:865px">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4 class="modal-title" id="updateClassModalLabel">课程修改</h4>
					</div>
					<form action="/videoServer/videoTab/upCoursesById.do" method="post"
						enctype="multipart/form-data">
						<div style="width: 860px;">
							<div style="height: 30px; background: #D9ECFF;"></div>
							<div style="height: 50px;">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px;">课程名称：</div>
								<div
									style="width: 300px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">
									<input type="text" style="width: 100%; height: 100%;"
										id="updatename" /> <input type="hidden" id="updatecourseId" />
								</div>
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程类型：</div>
								<div
									style="width: 250px; height: 50px; float: left; border: 1px solid #CADEFD;">
									<select style="text-align: center;width:100%;height:100%;" id="updatekctype"></select>
								</div>
							</div>
							<div style="height: 200px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 200px; line-height: 200px;">选择视频：</div>
								<div
									style="width: 700px; height: 200px; float: left; overflow: scroll; border: 1px solid #CADEFD;">
									<!-- <select id="courses_video"><option>请选择视频</option></select> -->
									<table id="update_courses_video" class='table table-bordered'></table>
								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程图片：</div>
								<div
									style="width: 700px; height: 50px; float: left; border: 1px solid #CADEFD;">

									&nbsp;<input type="file" id="update_courses_image"
										accept="image/*">

								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程价格：</div>
								<div
									style="width: 700px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">

									<input type="text" id="updatejiage"
										style="width: 100%; height: 50px;"
										placeholder="请输入课程价格，如99.99" onkeyup="checknum(this);" />

								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">课程现价：</div>
								<div
									style="width: 700px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">

									<input type="text" id="updatexianjia"
										style="width: 100%; height: 50px;"
										placeholder="请输入课程价格，如99.99" onkeyup="checknum(this);" />

								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									  style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">排序权重：</div>
								<div style="width: 700px; height: 50px; float: left;">
									&nbsp;
									<div style="margin-left: 320px;">
										<input type="button" style="border-right: 0px;"
											onClick="disNum(this)" value="-"><input type="text"
											value="0" id="update_courses_qz"
											style="width: 30px; text-align: center"
											onkeyup="value=value.replace(/[^\d]/g,'1')" /><input
											type="button" value="+" style="border-left: 0px;"
											onClick="incNum(this)">
									</div>
								</div>
							</div>
							<div style="height: 350px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 350px; line-height: 350px;">课程介绍：</div>

								<div style="width: 650px; height: 325px; float: left;">
									 <div id="div3" class="toolbar"></div>
									 <div id="div4" class="text"> 
                                         
                                      </div>
								</div>								
							</div>
						</div>
					</form>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal"
							id="quxiao2">取消</button>
						<button type="button" class="btn btn-primary" id="updateClass">提交</button>
					</div>
				</div>
			</div>
		</div>

		<input type="hidden" id="teacher_id" />
	</div>
	<script src="assets/js/jquery-1.10.2.js"></script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="assets/js/jquery.metisMenu.js"></script>
	<script src="assets/js/dataTables/jquery.dataTables.js"></script>
	<script src="assets/js/dataTables/dataTables.bootstrap.js"></script>
	<script src="assets/js/common.js"></script>

	<script>
	 var pageSize = 8;    //每页显示的记录条数
     var curPage=0;        //当前页
     var lastPage;        //最后页
     var direct=0;        //方向
     var len;            //总行数
     var page;            //总页数
     var begin;
     var end;
     var datalist;//数据
     var introcontent1;
     var introcontent2;
	$(document).ready(function () {
		loadRoleInfo();
	    $('#dataTables-example').dataTable();
	});
	$(function(){		
		getVideoForm();		 
		$.ajax({
			type : 'post',
			url : '/videoServer/coursesTab/getTabList.do',
			data:{name:1},
			success : function(data){	
				datalist = data;
				 getPage();
				showdata();				
				$("#teacher_id").val(data[0].teacher_id);
			},error: function(){
			}
		});
		$.ajax({
			type : 'post',
			url : '/videoServer/videoTab/getVideoTabs.do',
			data:{name:1},
			success : function(meg){
				$("#courses_video").empty(); 
				$("#update_courses_video").empty();
				for (var i = 0; i < meg.length; i++) {
			    	$("#courses_video").append("<tr><td><input type='checkbox' name='videoId' value="+meg[i].video_id+">"+ meg[i].video_name + "</td></tr>");
			    	$("#update_courses_video").append("<tr><td><input type='checkbox' name='videoId' value="+meg[i].video_id+">"+ meg[i].video_name + "</td></tr>");
				}
			}
		})	
	})
	
function getPage(){    
        
	    len = datalist.length;     
        page=len % pageSize==0 ? len/pageSize : Math.floor(len/pageSize)+1;//根据记录条数，计算页数
        // alert("page==="+page);
        curPage=1;    // 设置当前为第一页
        displayPage(1);//显示第一页        
        document.getElementById("btn0").innerHTML="当前 " + curPage + "/" + page + " 页  ";    // 显示当前多少    
              
       /*  $("#pageSizeSet").click(function setPageSize(){    // 设置每页显示多少条记录
            pageSize = document.getElementById("pageSize").value;    //每页显示的记录条数
            if (!/^[1-9]\d*$/.test(pageSize)) {
                alert("请输入正整数");
                return ;
            }
            len =$("#mytable tr").length - 1;
            page=len % pageSize==0 ? len/pageSize : Math.floor(len/pageSize)+1;//根据记录条数，计算页数
            curPage=1;        //当前页
             direct=0;        //方向
             firstPage();
        });	          */
        	   
    }
	  $("#btn1").click(function firstPage(){    // 首页
          curPage=1;
          direct = 0;
          displayPage();
          showdata();
      });
      $("#btn2").click(function frontPage(){    // 上一页
          direct=-1;
          displayPage();
          showdata();
      });
      $("#btn3").click(function nextPage(){    // 下一页
          direct=1;
          displayPage();
          showdata();
      });
      $("#btn4").click(function lastPage(){    // 尾页
          curPage=page;
          direct = 0;
          displayPage();
          showdata();
      });
      $("#btn5").click(function changePage(){    // 转页
          curPage=document.getElementById("changePage").value * 1;
          if (!/^[1-9]\d*$/.test(curPage)) {
              alert("请输入正整数");
              return ;
          }
          if (curPage > page) {
              alert("超出数据页面");
              return ;
          }
          direct = 0;
          displayPage();
          showdata();
      });
      
	 function displayPage(){
         if(curPage <=1 && direct==-1){
             direct=0;
             alert("已经是第一页了");
             return;
         } else if (curPage >= page && direct==1) {
             direct=0;
             alert("已经是最后一页了");
             return ;
         }        
         lastPage = curPage;      
         // 修复当len=1时，curPage计算得0的bug
         if (len > pageSize) {
             curPage = ((curPage + direct + len) % len);
         } else {
             curPage = 1;
         }
   
         document.getElementById("btn0").innerHTML="当前 " + curPage + "/" + page + " 页  ";        // 显示当前多少页         
         begin=(curPage-1)*pageSize + 1;// 起始记录号
         end = begin + 1*pageSize - 1;    // 末尾记录号
         
         if(end > len ) end=len;
       /*   $("#mytable tr").hide();    // 首先，设置这行为隐藏
         $("#mytable tr").each(function(i){    // 然后，通过条件判断决定本行是否恢复显示
             if((i>=begin && i<=end) || i==0 )//显示begin<=x<=end的记录
                 $(this).show();
         }); */

      } 
	 function showdata(){
		 $("#tb").empty(); 
	
		 for(var i=begin-1;i<end;i++){			
				var videoformname = datalist[i].video_form_class+datalist[i].video_form_name;
				if(datalist[i].courses_status=='8'){//<td class='wrap' title='"+datalist[i].courses_introduce+"'>"+datalist[i].courses_introduce+"</td>
					$("#tb").append("<tr><td>"+(i+1)+"</td><td class='wrap' title='"+datalist[i].courses_name+"'>"+datalist[i].courses_name+"</td><td>"+videoformname+"</td><td>"+datalist[i].courses_video+"</td><td class='wrap' title='"+datalist[i].courses_img_url+"'>"+datalist[i].courses_img_url+"</td><td>"+datalist[i].courses_pricemoney+"</td><td>"+datalist[i].courses_grade+"</td><td>"+datalist[i].courses_click+"</td><td>"+datalist[i].courses_qz+"</td><td><button class='btn btn-danger btn-sm' data-toggle='modal' data-target='#updateClassModal'  data-upcourseid='"+datalist[i].courses_id+"'>视频修改</button></td><td onclick='delet(this)'><input type='button' value='下线'><input type='hidden' id='a' value='"+datalist[i].courses_id+"'/></td></tr>")
				}else if(datalist[i].courses_status=='9'){
					$("#tb").append("<tr><td>"+(i+1)+"</td><td class='wrap' title='"+datalist[i].courses_name+"'>"+datalist[i].courses_name+"</td><td>"+videoformname+"</td><td>"+datalist[i].courses_video+"</td><td class='wrap' title='"+datalist[i].courses_img_url+"'>"+datalist[i].courses_img_url+"</td><td>"+datalist[i].courses_pricemoney+"</td><td>"+datalist[i].courses_grade+"</td><td>"+datalist[i].courses_click+"</td><td>"+datalist[i].courses_qz+"</td><td><button class='btn btn-danger btn-sm' data-toggle='modal' data-target='#updateClassModal'  data-upcourseid='"+datalist[i].courses_id+"'>视频修改</button></td><td onclick='delet(this)'><input type='button' value='上线'><input type='hidden' id='a' value='"+datalist[i].courses_id+"'/></td></tr>")
				} 

			}
	 }	  
	 
	//输入金额
	function checknum(obj)
   {   
     if(/^\d+\.?\d{0,2}$/.test(obj.value)){
        obj.value = obj.value;
     }else{
        obj.value = obj.value.substring(0,obj.value.length-1);
     }     
   }
	//拉取视频
	function getVideoTabs(video_form_id){
		$.ajax({
			type : 'post',
			data : {video_form_id:video_form_id},
			url : '/videoServer/videoTab/selVideobyVideoForm.do',
			success : function(meg){
				$("#courses_video").empty(); 
				$("#update_courses_video").empty(); 				
				for (var i = 0; i < meg.length; i++) {
			    	//$("#courses_video").append("<option>["+meg[i].video_id+"]" + meg[i].video_name + "</option>");
			    	$("#courses_video").append("<tr><td><input type='checkbox' name='videoId' value="+meg[i].video_id+">"+ meg[i].video_name + "</td></tr>");
			    	$("#update_courses_video").append("<tr><td><input type='checkbox' name='videoId' value="+meg[i].video_id+">"+ meg[i].video_name + "</td></tr>");
			    }
			}
		})
	}
	//拉取课程类型
	function getVideoForm(){
		$.ajax({
			type: "POST",
			url : '/videoServer/videoFormTab/getVideoList.do',		
			data:{name:1},
			cache: false,  //禁用缓存
            dataType: "json",
			success : function(data){
				$("#kctype").empty(); 
				$("#video_form_name").empty(); 
				$("#updatekctype").empty(); 
				for (var i = 0; i < data.length; i++) {			    	
			    	$("#kctype").append("<option value="+data[i].video_form_id+">"+data[i].video_form_class+data[i].video_form_name+"</option>");
			    	$("#video_form_name").append("<option value="+data[i].video_form_id+">"+data[i].video_form_class+data[i].video_form_name+"</option>");
			    	$("#updatekctype").append("<option value="+data[i].video_form_id+">"+data[i].video_form_class+data[i].video_form_name+"</option>");
				}
			},error: function(){
				alert("VideoForm error"); 
			}
		});
	}
	 $("select#kctype").change(function(){
	    var video_form_id = $(this).val();
	    getVideoTabs(video_form_id);
	 }); 
	 $("select#updatekctype").change(function(){
		    var video_form_id = $(this).val();
		    getVideoTabs(video_form_id);
	});
	/* function updat(obj){
		var orderId=$(obj).html();
		var d=0;
	 	if ((navigator.userAgent.indexOf('MSIE') >= 0) && (navigator.userAgent.indexOf('Opera') < 0)){
	 		d=orderId.substring(67,orderId.length-2)
	 	}
	 	if (navigator.userAgent.indexOf('Firefox') >= 0){
	 		d=orderId.substring(53,orderId.length-16)
	 	}else{
	 		d=orderId.substring(67,orderId.length-2);
	 	}
		window.location.href="updateClass.html?id="+d;
	} */
	function delet(obj){
		var orderId=$(obj).html();
		var d=0;
	 	if ((navigator.userAgent.indexOf('MSIE') >= 0) && (navigator.userAgent.indexOf('Opera') < 0)){
	 		d=orderId.substring(67,orderId.length-2)
	 	}
	 	if (navigator.userAgent.indexOf('Firefox') >= 0){
	 		d=orderId.substring(53,orderId.length-16)
	 	}else{
	 		d=orderId.substring(67,orderId.length-2);
	 	}
	 	if(orderId.indexOf("下线") != -1){
			$.ajax({
		       	type : 'post',
		       	url : '/videoServer/coursesTab/delCoursesById.do?',
		       	data:{id:d},
		       	success : function(){
		       		alert("操作成功");
		       		//window.location.href="";
		       		window.location.reload();
		       	}
		    })
		 }else{
		 	$.ajax({
		       	type : 'post',
		       	url : '/videoServer/coursesTab/updateCoursesById.do?',
		    	data:{id:d},
		       	success : function(){
		       		alert("操作成功");
		       		//window.location.href="";
		       		window.location.reload();
		       	}
		    })
		 }
	}
 </script>
	<script>
 
//加载模态框    
 $('#myModal').on('show.bs.modal', function (event) {     
	   $("#name").val(""); 
	   $("#jiage").val("");
	   $("#xianjia").val("");
	   editor1.txt.clear();
	   var video_form_id =$.trim($("#kctype").val());
	   getVideoTabs(video_form_id);
	 
 }); 
	$("#sub").click(function(){
		var str="";
		$("input[name='videoId']").each(function(){    
             if($(this).is(":checked")){    
                 str +=$(this).val()+",";    
             }    
         });	
		//表单参数
		 var formData = new FormData();  //重点：要用这种方法接收表单的参数  	
		 var courses_name = $.trim($("#name").val());  
		 var courses_video_form_id = $.trim($("#kctype").val());		
		 var image = $('#courses_image').prop("files")[0];
		 var courses_pricemoney =$.trim($("#jiage").val());
		 getContent1();
		 var courses_introduce = introcontent1;
		 var courses_video = str.substring(0,str.length-1);
		 var courses_qz = $.trim($("#courses_qz").val());	
		 var coures_price =$.trim($("#xianjia").val());
		 formData.append("courses_name",courses_name);  
		 formData.append("courses_video_form_id", courses_video_form_id); 
		 formData.append("image", image);
		 formData.append("courses_pricemoney", courses_pricemoney); 
		 formData.append("courses_introduce", courses_introduce);
		 formData.append("courses_video", courses_video);
		 formData.append("courses_qz", courses_qz);
		 formData.append("coures_price", coures_price);
		$.ajax({
			type : 'post',
			data : formData,	
			contentType: false, 
	        processData: false, 
			url : '/videoServer/coursesTab/addCoursesTab.do',
			success : function(){
				alert("提交成功");
			//	window.location.href="";
				window.location.reload();
				editor1.txt.clear();
				$("#myModal").modal("hide");
			}
		})
	
	})

	//加载课程修改模态框    
 $('#updateClassModal').on('show.bs.modal', function (event) {     
	 var button = $(event.relatedTarget); // 触发事件的按钮  
     var courseId = button.data('upcourseid') ;// 解析出data-whatever内容  
	  $("#updatecourseId").val(courseId);
	 $.ajax({
			type : 'post',
	       	url : '/videoServer/coursesTab/getTabListById.do?',
	    	data:{id:courseId},
	       	success : function(data){	       	 
	       		$("#updatename").val(data[0].courses_name);
	       		$("#updatejiage").val(data[0].courses_pricemoney);
	       		//$("#update_courses_introduce").val(data[0].courses_introduce);
	       	    editor2.txt.html(data[0].courses_introduce);
	       		$("#updatexianjia").val(data[0].coures_price);
	       		$("#update_courses_qz").val(data[0].courses_qz);
	       	    $("#updatekctype").val(data[0].video_form_id);
	        	 var video_form_id =$.trim($("#updatekctype").val());
	  	          getVideoTabs(video_form_id);
	       	   // console.log(data[0].courses_video);
	       	 /*   var videostr = data[0].courses_video;
	       	  var String[] videos = videostr.split(",");
	       	   for (var i = 0; i < videostr.size; i++) {
	       		 $("input[type='checkbox']:val="+i+"").prop("checked", true);
			   } */
	       	}
		});		 
 }); 
	$("#queryorder").click(function(){
		$.ajax({
			type : 'post',
			data : {teacher_id:$.trim($("#teacher_id").val()),courses_video_form_id:$.trim($("#video_form_name").val()),courses_name:$.trim($("#courses_name").val()),courses_grade:$("#courses_grade").val(),courses_pricemoney:$.trim($("#courses_pricemoney").val())},
			url : '/videoServer/coursesTab/searchTabListBy.do',
			success : function(data){
				if(data.length==0){
			 		alert("暂无符合条件的课程");
			 	}else{
			 		$("#tb  tr:not(:first)").html("");
			 		datalist = data;
					 getPage();
					showdata();
			 		/* for(var i=0;i<data.length;i++){
			 			var videoformname = data[i].video_form_class+data[i].video_form_name;
						if(data[i].courses_status=='8'){
							$("#tb").append("<tr><td>"+(i+1)+"</td><td class='wrap' title='"+data[i].courses_name+"'>"+data[i].courses_name+"</td><td>"+videoformname+"</td><td class='wrap' title='"+data[i].courses_introduce+"'>"+data[i].courses_introduce+"</td><td>"+data[i].courses_video+"</td><td class='wrap' title='"+data[i].courses_img_url+"'>"+data[i].courses_img_url+"</td><td>"+data[i].courses_pricemoney+"</td><td>"+data[i].courses_grade+"</td><td>"+data[i].courses_click+"</td><td>"+data[i].courses_qz+"</td><td><button class='btn btn-danger btn-sm' data-toggle='modal' data-target='#updateClassModal' data-upcourseid='"+data[i].courses_id+"'>视频修改</button></td><td onclick='delet(this)'><input type='button' value='下线'><input type='hidden' id='a' value='"+data[i].courses_id+"'/></td></tr>")
						}else if(data[i].courses_status=='9'){
							$("#tb").append("<tr><td>"+(i+1)+"</td><td class='wrap' title='"+data[i].courses_name+"'>"+data[i].courses_name+"</td><td>"+videoformname+"</td><td class='wrap' title='"+data[i].courses_introduce+"'>"+data[i].courses_introduce+"</td><td>"+data[i].courses_video+"</td><td class='wrap' title='"+data[i].courses_img_url+"'>"+data[i].courses_img_url+"</td><td>"+data[i].courses_pricemoney+"</td><td>"+data[i].courses_grade+"</td><td>"+data[i].courses_click+"</td><td>"+data[i].courses_qz+"</td><td><button class='btn btn-danger btn-sm' data-toggle='modal' data-target='#updateClassModal' data-upcourseid='"+data[i].courses_id+"'>视频修改</button></td><td onclick='delet(this)'><input type='button' value='上线'><input type='hidden' id='a' value='"+data[i].courses_id+"'/></td></tr>")
						}
					} */
				}
			},error: function(){
			}
		})
	});
	
	$("#eliminates").click(function(){	
		//window.location.href="";
		window.location.reload();
	});
		
	$("#updateClass").click(function(){		
		var str="";
		$("input[name='videoId']").each(function(){    
             if($(this).is(":checked")){    
                 str +=$(this).val()+",";    
             }    
         });	
		//表单参数
		 var formData = new FormData();  //重点：要用这种方法接收表单的参数  	
		 var course_id =  $("#updatecourseId").val();
		 var courses_name = $.trim($("#updatename").val());  
		 var courses_video_form_id = $.trim($("#updatekctype").val());		
		 var image = $('#update_courses_image').prop("files")[0];
		 var courses_pricemoney =$.trim($("#updatejiage").val());
		 getContent2();
		 var courses_introduce =introcontent2 ;		
		 var courses_video = str.substring(0,str.length-1);
		 var courses_qz = $.trim($("#update_courses_qz").val());
		 var coures_price =$.trim($("#updatexianjia").val());
		 formData.append("courses_id",course_id);
		 formData.append("courses_name",courses_name);  
		 formData.append("courses_video_form_id", courses_video_form_id); 
		 formData.append("image", image);
		 formData.append("courses_pricemoney", courses_pricemoney); 
		 formData.append("courses_introduce", courses_introduce);
		 formData.append("courses_video", courses_video);
		 formData.append("courses_qz", courses_qz);	
		 formData.append("coures_price", coures_price);	
		
		$.ajax({
			type : 'post',
			data : formData,	
			contentType: false, 
	        processData: false, 
			url : '/videoServer/coursesTab/upCoursesById.do',
			success : function(){
				alert("提交成功");
				//window.location.href="";
				window.location.reload();
				editor2.txt.clear();
				$("#updateClassModal").modal("hide");
			}
		});
	
	});
	
	
</script>
	<script>
	function disNum(dom){
		var disNum=dom.nextSibling.value;
		if(disNum<1)//防止数量少于1
		{
			dom.nextSibling.value=0;
		}
		else
		{
			dom.nextSibling.value--;
		}
	}
	
	function incNum(dom){
		dom.previousSibling.value ++;
	}
</script>
	<script src="assets/js/custom-scripts.js"></script>
	<!-- fuwenben -->
   <script type="text/javascript">
       var E = window.wangEditor;
       var editor1 = new E('#div1', '#div2')  ;
        // 或者 var editor = new E( document.getElementById('editor') )
        editor1.customConfig.uploadImgShowBase64 = true ;  // 使用 base64 保存图片
        editor1.customConfig.zIndex = 100;
        editor1.create();
         function getContent1(){      
        // 读取 html
            introcontent1 = editor1.txt.html();
           
        };
        var editor2 = new E('#div3', '#div4')  ;
        // 或者 var editor = new E( document.getElementById('editor') )
        editor2.customConfig.uploadImgShowBase64 = true ;  // 使用 base64 保存图片
        editor2.customConfig.zIndex = 100;
        editor2.create();
         function getContent2(){      
        // 读取 html
            introcontent2 = editor2.txt.html();
           
        };

    </script>
</body>
</html>
