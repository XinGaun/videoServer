<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>视频修改</title>
<script src="js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="js/jquery.easyui.min.js"></script>
<script type="text/javascript" src="js/easyui-lang-zh_CN.js"></script>
</head>
<body>
	<div>
		<form action="/videoServer/videoTab/uploadflv1.do" method="post"
						enctype="multipart/form-data" id="dataForm">
						<div style="width: 100%;">
							<div
								style="height: 30px; background: #D9ECFF; border: 1px solid #CADEFD"></div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">视频标题：</div>
								<div
									style="width: 200px; height: 50px; float: left; line-height: 50px; border: 1px solid #CADEFD;">
									<input type="text" style="width: 100%; height: 100%;"
										name="videoName" id="videoName">
								</div>
								<div
									style="width: 100px;; background: #D9ECFF; float: left; text-align: right; height: 50px; line-height: 50px;">视频类型：</div>
								<div
									style="width: 130px; height: 50px; float: left; border: 1px solid #CADEFD;">
									<select style="width: 100%; text-align: center;" id="kctype">

									</select>
								</div>
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">视频封面：</div>
								<input type="file" name="image" id="image" accept="image/*">
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">视频PPT：</div>
								<input type="file" name="ppt" id="ppt">
							</div>
							<div style="height: 50px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 50px; line-height: 50px;">视频权重：</div>
								<div style="width: 440px; height: 50px; float: left;">
									<div style="margin-top: 25px; margin-left: 25px;">
										<input type="button" style="border-right: 0px;"
											onClick="disNum(this)" value="-"><input type="text"
											value="0" id="video_qz"
											style="width: 30px; text-align: center"
											onkeyup="value=value.replace(/[^\d]/g,'1')" /><input
											type="button" value="+" style="border-left: 0px;"
											onClick="incNum(this)">
									</div>
								</div>
							</div>
							<div style="height: 100px; border: 1px solid #CADEFD">
								<div
									style="width: 150px; background: #D9ECFF; float: left; border: 1px solid #CADEFD; text-align: right; height: 100px; line-height: 100px;">视频介绍：</div>
								<div
									style="width: 440px; height: 100px; float: left; border: 1px solid #CADEFD;">
									<textarea style="width: 100%; height: 100%;"
										name="video_introduce" id="video_introduce"></textarea>
									<input type="hidden" name="video_introduce">
								</div>
							</div>

						</div>
					</form> 
		        <div style="height:50px;border:1px solid #CADEFD">
					<div style="width:150px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:50px;line-height:50px;"></div>
					<div style="width:440px;height:50px;float:left;line-height:50px;">
						&nbsp;<input type="button" onclick="updat()" value="修改">&nbsp;&nbsp;<a href="javascript:history.back(-1)"><input type="button" value="返回"></a>
					</div>
				</div>
	</div>
</body>
<script>
	/* $("#sub").click(function(){
		var aa=document.getElementById("video_url").value.toLowerCase().split('.');//以“.”分隔上传文件字符串
		//判断图片格式
		if(aa[aa.length-1]=='mp4'||aa[aa.length-1]=='webm'||aa[aa.length-1]=='ogv'||aa[aa.length-1]=='png'||aa[aa.length-1]=='jpeg'){
			$.ajax({
				type : 'post',
				data : {video_name:$("#video_name").val(),video_url:$("#video_url").val(),video_img_url:$("#video_img_url").val(),video_introduce:$("#video_introduce").val()},
				url : '/videoServer/videoTab/uploadflv.do',
				success : function(){
					alert("suc");
				},error: function(){
					alert("error");
				}
			})
		}else{
			alert("请上传mp4，webm，ogv类型的视频文件");
		}
	})	 */
	$(function(){
		var url = location.search;
		var args = url.split("?");
		var d=args[1].substring(9);
		
		$.ajax({
			type : 'post',
	       	url : '/videoServer/videoTab/getVideoById.do?id='+d,
	       	success : function(data){
	       		$("#videoName").val(data[0].video_name)；
	       		$("#video_introduce").val(data[0].video_introduce);
	       	}
		})
	})
	function updat(obj){
		var url = location.search;
		var args = url.split("?");
		var d=args[1].substring(9);
		//表单参数
		 var formData = new FormData();  //重点：要用这种方法接收表单的参数  	
		 var videoName = $.trim($('#videoName').val());  
		 var video_introduce =$.trim($("#video_introduce").val());
		 var video_form_id = $.trim($("#kctype").val());
		 var image = $('#image').prop("files")[0];
		 var ppt = $('#ppt').prop("files")[0];
		 var video_qz = $.trim($("#video_qz").val());	
		 formData.append("videoName",videoName);  	
		 formData.append("image", image);
		 formData.append("video_introduce", video_introduce);
		 formData.append("video_form_id", video_form_id);
		 formData.append("ppt", ppt);	
		 formData.append("video_qz", video_qz);
		 
		$.ajax({
	       	type : 'post',
	       	url : '/videoServer/videoTab/updetVideoById.do?video_id='+d,
	       	data : formData,
	       	success : function(data){
	       		alert("修改成功！")
	       		window.location.href="videoInfo.html";
	       	}
	    })
	}
</script>
</html>