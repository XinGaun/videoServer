<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="js/jquery.easyui.min.js"></script>
<script type="text/javascript" src="js/easyui-lang-zh_CN.js"></script>
</head>
<body>
	<div>
		<form action="/videoServer/videoTab/uploadflv1.do" method="post">
			<div style="margin:0 auto;width:600px;border:1px solid blue">
				<div style="height:30px;background:#D9ECFF;border:1px solid #CADEFD"></div>
				<div style="height:50px;border:1px solid #CADEFD">
					<div style="width:150px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:50px;line-height:50px;">视频标题：</div>
					<div style="width:200px;height:50px;float:left;line-height:50px;border:1px solid #CADEFD;">
						&nbsp;<input type="text" id="video_name"/><input type="hidden" name="video_name"/>
					</div>
					<div style="width:100px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:50px;line-height:50px;">视频类型：</div>
					<div style="width:100px;height:50px;float:left;line-height:50px;">
						&nbsp;<input style="width:80px;"type="text" id="video_form_id"/>
					</div>
				</div>
				<div style="height:50px;border:1px solid #CADEFD">
					<div style="width:150px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:50px;line-height:50px;">选择视频：</div>
					<div style="width:440px;height:50px;float:left;line-height:50px;">
						&nbsp;<input type="file" accept="video/*" id="video_url"><input type="hidden"  name="video_url">
					</div>
				</div>
				<div style="height:50px;border:1px solid #CADEFD">
					<div style="width:150px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:50px;line-height:50px;">视频封面：</div>
					<div style="width:440px;height:50px;float:left;line-height:50px;">
						&nbsp;<input type="file" id="video_img_url"><input type="hidden" name="video_img_url">
					</div>
				</div>
				<div style="height:100px;border:1px solid #CADEFD">
					<div style="width:150px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:100px;line-height:100px;">视频介绍：</div>
					<div style="width:440px;height:100px;float:left;">
						&nbsp;<textarea  style="width:250px;margin-top:25px;height:50px;" id="video_introduce"></textarea><input type="hidden" name="video_introduce">
					</div>
				</div>
				<div style="height:50px;border:1px solid #CADEFD">
					<div style="width:150px;background:#D9ECFF;float:left;border:1px solid #CADEFD;text-align:right;height:50px;line-height:50px;"></div>
					<div style="width:440px;height:50px;float:left;line-height:50px;">
						&nbsp;<input type="button" onclick="updat()" value="修改">&nbsp;&nbsp;<a href="javascript:history.back(-1)"><input type="button" value="返回"></a>
					</div>
				</div>
			</div>
		</form> 
	</div>
</body>
<script>
	$("#sub").click(function(){
		var aa=document.getElementById("video_url").value.toLowerCase().split('.');//以“.”分隔上传文件字符串
		//判断图片格式
		if(aa[aa.length-1]=='mp4'||aa[aa.length-1]=='webm'||aa[aa.length-1]=='ogv'||aa[aa.length-1]=='png'||aa[aa.length-1]=='jpeg'){
			$.ajax({
				type : 'post',
				data : {video_name:$("#video_name").val(),video_url:$("#video_url").val(),video_img_url:$("#video_img_url").val(),video_introduce:$("#video_introduce").val()},
				url : '/videoServer/videoTab/uploadflv.do',
				success : function(){
					alert("suc");
				},error: function(){
					alert("error");
				}
			})
		}else{
			alert("请上传mp4，webm，ogv类型的视频文件");
		}
	})	
	$(function(){
		var url = location.search;
		var args = url.split("?");
		var d=args[1].substring(9);
		$.ajax({
			type : 'post',
	       	url : '/videoServer/videoTab/getVideoById.do?id='+d,
	       	success : function(data){
	       		$("#video_name").val(data[0].video_name);
	       		$("#video_form_id").val(data[0].video_form_id);
	       		$("#video_introduce").val(data[0].video_introduce);
	       	}
		})
	})
	function updat(obj){
		var url = location.search;
		var args = url.split("?");
		var d=args[1].substring(9);
		$.ajax({
	       	type : 'post',
	       	url : '/videoServer/videoTab/updetVideoById.do?video_id='+d,
	       	data : {video_name:$("#video_name").val(),video_url:$("#video_url").val(),video_img_url:$("#video_img_url").val(),video_introduce:$("#video_introduce").val()},
	       	success : function(data){
	       		alert("修改成功！")
	       		window.location.href="videoInfo.html";
	       	}
	    })
	}
</script>
</html>