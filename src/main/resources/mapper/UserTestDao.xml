<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.UserTestDao">
	<!-- 添加题目信息 -->
	<insert id="addUserTest" parameterType="java.util.HashMap" useGeneratedKeys="true" keyProperty="test_id">
		INSERT INTO user_test(test_subject, test_answer, test_grade,test_type) VALUES (#{test_subject},'${test_answer}',#{test_grade},#{test_type})
	</insert>
	<!-- 添加答案信息 -->
	<insert id="addUserTestAnswer" parameterType="java.util.HashMap">
		INSERT INTO user_test_answer(test_id, answer_content, test_answer) VALUES (#{test_id},#{answer_content},#{test_answer})
	</insert>
	<!-- 查询题目信息 -->
	<select id="queryUserTest" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT test_id,test_subject,test_answer,test_grade,test_type FROM user_test WHERE 1=1 
		<if test="test_id!=''">
			and test_id = #{test_id}
		</if>
		<if test="test_subject!=''">
			and test_subject like '%${test_subject}%'
		</if>
		<if test="test_grade!=''">
			and test_grade = #{test_grade}
		</if>
		 ORDER BY test_id DESC LIMIT #{nums},#{page}
	</select>
	<!-- 查询题目信息总数 -->
	<select id="queryUserTestCount" resultType="int" parameterType="java.util.HashMap">
		SELECT count(test_id) FROM user_test where 1=1 
		<if test="test_id!=''">
			and test_id = #{test_id}
		</if>
		<if test="test_subject!=''">
			and test_subject like '%${test_subject}%'
		</if>
		<if test="test_grade!=''">
			and test_grade = #{test_grade}
		</if>
	</select>
	<!-- 查询答案信息 -->
	<select id="queryUserTestAnswer" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT answer_id,test_id,answer_content,test_answer FROM user_test_answer WHERE test_id = #{test_id}
	</select>
	<!-- 修改题目信息 -->
	<update id="updateUserTest" parameterType="java.util.HashMap">
		UPDATE user_test SET test_subject  =#{test_subject} ,test_answer =#{test_answer} ,test_grade =#{test_grade},test_type=#{test_type} WHERE test_id =#{test_id} 
	</update>
	<!-- 删除答案信息 -->
	<delete id="deteleTestAnswer" parameterType="java.util.HashMap">
		DELETE FROM user_test_answer WHERE test_id = #{test_id}
	</delete>
	<!-- 删除题目信息 -->
	<delete id="deteleUserTest" parameterType="java.util.HashMap">
		DELETE FROM user_test WHERE test_id = #{test_id}
	</delete>
</mapper>