<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.VideosDao">
	<!-- 查询所有课程 -->
	<select id="querycoursesTabAll" resultType="java.util.HashMap" parameterType="java.util.HashMap">
		SELECT courses_id,teacher_tab.teacher_id,teacher_name,courses_name,courses_introduce,courses_pricemoney,courses_click,courses_img_url,courses_grade,date_format(courses_date,'%Y-%m-%d')courses_date FROM courses_tab
		LEFT JOIN teacher_tab ON courses_tab.teacher_id=teacher_tab.teacher_id 
		LEFT JOIN video_form_tab ON video_form_tab.video_form_id = courses_tab.video_form_id 
 		WHERE 1=1 AND courses_status = 5 
 		<if test="keyword!=''">
 			AND courses_name like '%${keyword}%' 
 		</if>
 		<if test="queryAll!=''">
 			AND video_form_tab.video_form_class = #{queryAll} 
 		</if>
 		ORDER BY 
 		<if test="sort==0">
 			courses_click DESC,courses_grade DESC,courses_date DESC 
 		</if>
 		<if test="sort==null">
 			courses_click DESC,courses_grade DESC,courses_date DESC 
 		</if>
 		<if test="sort==1">
 			courses_date DESC 
 		</if>
 		<if test="sort==2">
 			courses_click DESC 
 		</if>
 		<if test="sort==3">
 			courses_pricemoney+0 DESC  
 		</if>
 		LIMIT #{nums},#{page}
	</select>
	<!-- 查询所有课程总数 -->
	<select id="querycoursesTabAllCount" parameterType="java.util.HashMap" resultType="int">
		SELECT COUNT(courses_id) FROM courses_tab
		LEFT JOIN teacher_tab ON courses_tab.teacher_id=teacher_tab.teacher_id 
		LEFT JOIN video_form_tab ON video_form_tab.video_form_id = courses_tab.video_form_id 
 		WHERE 1=1 AND courses_status = 5 
 		<if test="keyword!=''">
 			AND courses_name like '%${keyword}%' 
 		</if>
 		<if test="queryAll!=''">
 			AND video_form_tab.video_form_class = #{queryAll} 
 		</if>
	</select>
	<!-- 查询所有推荐课程 -->
	<select id="queryRecommend" resultType="java.util.HashMap">
		SELECT
		teacher_name,courses_id,teacher_tab.teacher_id,courses_name,courses_introduce,courses_pricemoney,courses_click,courses_img_url,courses_grade,date_format(courses_date,'%Y-%m-%d')courses_date
		FROM courses_tab
		LEFT JOIN teacher_tab ON
		teacher_tab.teacher_id=courses_tab.teacher_id
		WHERE 1=1 AND
		courses_status = 5 order by courses_date DESC LIMIT 0,3
	</select>
</mapper>