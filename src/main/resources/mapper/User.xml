<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.UserDaos">
	<!-- 添加注册用户 -->
	<insert id="addUser" parameterType="com.entity.UserTab">
		insert into user_tab(user_name,user_sex,user_phone,user_pwd,user_status,user_date,user_email,user_photo) 
 		values('',3,#{user_phone},'',5,now() ,'','')
	</insert>

	<!-- 登录注册时查询是否有该用户 -->

	<select id="queryUser" parameterType="String" resultType="java.util.HashMap">
		select user_id,user_phone,user_name,user_pwd,user_photo from user_tab where user_phone=#{phone}
		
	</select>

	<!-- 登录查询 -->

	<select id="selectUser" resultType="java.util.HashMap">
		select user_id,user_phone,user_name,user_pwd,user_photo from user_tab where user_phone=#{user_phone} and user_pwd=#{user_pwd}
		
	</select>


	<!-- 根据手机号更新密码 -->
	<update id="updateUser" parameterType="com.entity.UserTab">
		update user_tab set user_pwd=#{user_pwd} where user_phone=#{user_phone}
	</update>
	<!-- 个人中心更改所有信息 -->
	<update id="updatemessage" parameterType="com.entity.UserTab">
		update user_tab set user_name=#{user_name},user_sex=#{user_sex},user_email=#{user_email},user_truename=#{user_truename},user_qq=#{user_qq},user_photo=#{user_photo},user_self=#{user_self} where user_phone=#{user_phone}
	</update>
	<!-- 更改手机号 -->
	<update id="updatephone"  parameterType="com.entity.UserTab">
		update user_tab set user_phone=#{user_phone} where user_id=#{user_id}
	</update>
	<!-- 查询是否是第一次登录 -->
	<select id="isfirst"  parameterType="String" resultType="java.util.HashMap">
		select user_id from user_test_record where user_id =( select user_id from user_tab where user_phone=#{user_phone})
	</select>
	

</mapper>