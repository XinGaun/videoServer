<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dao.InstallUnitTabDao">
	<!-- 添加安装单位信息 -->
	<insert id="addInstallUnitTab" parameterType="com.entity.InstallUnitTab">
		INSERT INTO install_unit_tab(inst_unit_name, inst_unit_scope
		<if test="branch_id!=null">
			,branch_id
		</if>
		<if test="inst_unit_stop_status!=null">
			,inst_unit_stop_status
		</if>
		<if test="inst_unit_dete_status!=null">
			,inst_unit_dete_status
		</if>
		)
		VALUES (#{inst_unit_name},#{inst_unit_scope}
		<if test="branch_id!=null">
			,#{branch_id}
		</if>
		<if test="inst_unit_stop_status!=null">
			,#{inst_unit_stop_status}
		</if>
		<if test="inst_unit_dete_status!=null">
			,#{inst_unit_dete_status}
		</if>
		)
	</insert>
	
	<resultMap type="java.util.HashMap" id="branch_tab">
		<id property="bran_id" column="bran_id" />
		<result property="bran_name" column="bran_name" />
		<result property="bran_addr" column="bran_addr" />
	</resultMap>
	<resultMap type="java.util.HashMap" id="install_unit_tab">
		<id property="inst_unit_id" column="inst_unit_id" />
		<result property="inst_unit_name" column="inst_unit_name" />
		<result property="inst_unit_scope" column="inst_unit_scope" />
		<result property="inst_unit_stop_status" column="inst_unit_stop_status" />
		<result property="inst_unit_dete_status" column="inst_unit_dete_status" />
		<result property="branch_id" column="branch_id" />
		<collection property="branch_tab" resultMap="branch_tab"></collection>
	</resultMap>
	<!-- 查询安装单位信息 -->
	<select id="queryInstallUnitTab" resultMap="install_unit_tab"
		parameterType="java.util.HashMap">
		SELECT
		inst_unit_id,inst_unit_name,inst_unit_scope,inst_unit_stop_status,inst_unit_dete_status,branch_id,bran_id,bran_addr,bran_name
		FROM install_unit_tab install_unit
		LEFT JOIN branch_tab branch ON install_unit.branch_id = branch.bran_id
		WHERE 1=1
		<if test="inst_unit_id!=null">
			and inst_unit_id = #{inst_unit_id}
		</if>
		<if test="inst_unit_name!=null">
			and inst_unit_name = #{inst_unit_name}
		</if>
		<if test="inst_unit_scope!=null">
			and inst_unit_scope = #{inst_unit_scope}
		</if>
		<if test="inst_unit_stop_status!=null">
			and inst_unit_stop_status = #{inst_unit_stop_status}
		</if>
		<if test="inst_unit_dete_status!=null">
			and inst_unit_dete_status = #{inst_unit_dete_status}
		</if>
		<if test="branch_id!=null">
			and branch_id = #{branch_id}
		</if>
		LIMIT #{page} OFFSET #{nums}
	</select>
	<!-- 查询安装单位总数信息 -->
	<select id="queryInstallUnitTabCount" resultType="int"
		parameterType="java.util.HashMap">
		SELECT COUNT(inst_unit_id) FROM install_unit_tab install_unit
		LEFT JOIN branch_tab branch ON install_unit.branch_id = branch.bran_id WHERE 1=1
		<if test="inst_unit_id!=null">
			and inst_unit_id = #{inst_unit_id}
		</if>
		<if test="inst_unit_name!=null">
			and inst_unit_name = #{inst_unit_name}
		</if>
		<if test="inst_unit_scope!=null">
			and inst_unit_scope = #{inst_unit_scope}
		</if>
		<if test="inst_unit_stop_status!=null">
			and inst_unit_stop_status = #{inst_unit_stop_status}
		</if>
		<if test="inst_unit_dete_status!=null">
			and inst_unit_dete_status = #{inst_unit_dete_status}
		</if>
		<if test="branch_id!=null">
			and branch_id = #{branch_id}
		</if>
	</select>
	<!-- 更新安装单位信息 -->
	<update id="updateInstallUnitTab" parameterType="com.entity.InstallUnitTab">
		UPDATE install_unit_tab
		<trim prefix="set" suffixOverrides=",">
			<if test="inst_unit_name!=null">
				inst_unit_name=#{inst_unit_name},
			</if>
			<if test="inst_unit_scope!=null">
				inst_unit_scope=#{inst_unit_scope},
			</if>
			<if test="inst_unit_stop_status!=null">
				inst_unit_stop_status=#{inst_unit_stop_status},
			</if>
			<if test="inst_unit_dete_status!=null">
				inst_unit_dete_status=#{inst_unit_dete_status},
			</if>
			<if test="branch_id!=null">
				branch_id=#{branch_id},
			</if>
		</trim>
		WHERE inst_unit_id =#{inst_unit_id}
	</update>
	<!-- 删除安装单位 -->
	<update id="deleteInstallUnitTab" parameterType="int">
		UPDATE
		install_unit_tab SET inst_unit_dete_status = '已删除' WHERE inst_unit_id
		= #{inst_unit_id}
	</update>
</mapper>